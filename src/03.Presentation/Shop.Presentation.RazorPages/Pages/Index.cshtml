@page
@model IndexModel
@{
    ViewData["Title"] = "فروشگاه";
}

<div class="container">

    <!-- Page Title -->
    <h2 class="mb-4 fw-bold border-bottom pb-2">محصولات</h2>

    <div class="row g-4" dir="rtl">

        <!-- ===========================
             CATEGORY FILTER (RIGHT SIDE)
        ============================ -->
        <div class="col-md-3">
            <div class="card shadow-sm border-0">
                <div class="card-body">
                    <h5 class="card-title fw-bold mb-3">دسته‌بندی‌ها</h5>

                    <ul class="list-group list-group-flush">

                        <!-- All Products -->
                        <li class="list-group-item">
                            <a asp-page="./Index"
                               class="text-decoration-none d-block py-1
                                      @(Model.SelectedCategoryId == null ? "fw-bold text-primary" : "")">
                                همه محصولات
                            </a>
                        </li>

                        <!-- Dynamic Categories -->
                        @foreach (var category in Model.Categories)
                        {
                            <li class="list-group-item">
                                <a asp-page="./Index"
                                   asp-route-categoryId="@category.Id"
                                   class="text-decoration-none d-block py-1
                                              @(Model.SelectedCategoryId == category.Id ? "fw-bold text-primary" : "")">
                                    @category.Name
                                </a>
                            </li>
                        }

                    </ul>
                </div>
            </div>
        </div>

        <!-- ===========================
             PRODUCT LIST (LEFT SIDE)
        ============================ -->
        <div class="col-md-9">
            <div class="row g-4">

                @foreach (var product in Model.Products)
                {
                    <div class="col-md-4">
                        <div class="card shadow-sm border-0 h-100">

                            <!-- Product Image -->
                            <div class="text-center p-3">
                                <img src="@product.ImageUrl"
                                     alt="@product.Title"
                                     class="img-fluid rounded"
                                     style="max-height: 180px; object-fit: contain;">
                            </div>

                            <div class="card-body text-center">

                                <!-- Product Title -->
                                <h5 class="card-title fw-bold mb-2">@product.Title</h5>

                                <!-- Price -->
                                <p class="text-muted mb-1">قیمت:</p>
                                <p class="fw-bold fs-5 text-primary mb-3">
                                    @product.Price.ToString("N0") تومان
                                </p>

                                <!-- Buttons -->
                                <form method="post"
                                      asp-page-handler="AddToCart"
                                      class="d-flex justify-content-center gap-2">

                                    <input type="hidden" name="productId" value="@product.Id" />

                                    <button type="submit" class="btn btn-success px-3">
                                        خرید
                                    </button>

                                    <a asp-page="/Product"
                                       asp-route-id="@product.Id"
                                       class="btn btn-outline-primary px-3">
                                        جزئیات
                                    </a>

                                </form>

                            </div>
                        </div>
                    </div>
                }

            </div>
        </div>

    </div>
</div>
